window.HUB_EVENTS={ASSET_ADDED:"ASSET_ADDED",ASSET_DELETED:"ASSET_DELETED",ASSET_DESELECTED:"ASSET_DESELECTED",ASSET_SELECTED:"ASSET_SELECTED",ASSET_UPDATED:"ASSET_UPDATED",CONSOLE_CHANGE:"CONSOLE_CHANGE",CONSOLE_CLOSED:"CONSOLE_CLOSED",CONSOLE_EVENT:"CONSOLE_EVENT",CONSOLE_OMCMCED:"CONSOLE_OMCMCED",CONSOLE_RUN_COMMAND:"CONSOLE_RUN_COMMAND",CONSOLE_SERVER_CHANGE:"CONSOLE_SERVER_CHANGE",EMBED_ACTIVE_MCMC_CHANGE:"EMBED_ACTIVE_MCMC_CHANGE",EMBED_ACTIVE_THEME_CHANGE:"EMBED_ACTIVE_THEME_CHANGE",EMBED_ATTRIBUTE_CHANGE:"EMBED_ATTRIBUTE_CHANGE",EMBED_RESHOWN:"EMBED_RESHOWN",FORMAT_FINISH:"FORMAT_FINISH",FORMAT_ERROR:"FORMAT_ERROR",FORMAT_START:"FORMAT_START",IFRAME_PREVIEW_RELOAD_CSS:"IFRAME_PREVIEW_RELOAD_CSS",IFRAME_PREVIEW_URL_CHANGE:"IFRAME_PREVIEW_URL_CHANGE",KEY_PRESS:"KEY_PRESS",LINTER_FINISH:"LINTER_FINISH",LINTER_START:"LINTER_START",MCMC_CHANGE_SERVER:"MCMC_CHANGE_SERVER",MCMC_CHANGE:"MCMC_CHANGE",MCMC_EDITOR_CLOSE:"MCMC_EDITOR_CLOSE",MCMC_EDITOR_CODE_FOLD:"MCMC_EDITOR_CODE_FOLD",MCMC_EDITOR_ERRORS:"MCMC_EDITOR_ERRORS",MCMC_EDITOR_EXPAND:"MCMC_EDITOR_EXPAND",MCMC_EDITOR_FOLD_ALL:"MCMC_EDITOR_FOLD_ALL",MCMC_EDITOR_LOADED:"MCMC_EDITOR_LOADED",MCMC_EDITOR_REFRESH_REQUEST:"MCMC_EDITOR_REFRESH_REQUEST",MCMC_EDITOR_RESET_SIZES:"MCMC_EDITOR_RESET_SIZES",MCMC_EDITOR_SIZES_CHANGE:"MCMC_EDITOR_SIZES_CHANGE",MCMC_EDITOR_UI_CHANGE_SERVER:"MCMC_EDITOR_UI_CHANGE_SERVER",MCMC_EDITOR_UI_CHANGE:"MCMC_EDITOR_UI_CHANGE",MCMC_EDITOR_UI_DISABLE:"MCMC_EDITOR_UI_DISABLE",MCMC_EDITOR_UI_ENABLE:"MCMC_EDITOR_UI_ENABLE",MCMC_EDITOR_UNFOLD_ALL:"MCMC_EDITOR_UNFOLD_ALL",MCMC_ERROR_INFINITE_LOOP:"MCMC_ERROR_INFINITE_LOOP",MCMC_ERROR_RUNTIME:"MCMC_ERROR_RUNTIME",MCMC_ERRORS:"MCMC_ERRORS",MCMC_LIVE_CHANGE:"MCMC_LIVE_CHANGE",MCMC_LOGS:"MCMC_LOGS",MCMC_MANIFEST_CHANGE:"MCMC_MANIFEST_CHANGE",MCMC_MANIFEST_FULL:"MCMC_MANIFEST_FULL",MCMC_PREVIEW_FINISH:"MCMC_PREVIEW_FINISH",MCMC_PREVIEW_START:"MCMC_PREVIEW_START",MCMC_SAVED:"MCMC_SAVED",POPUP_CLOSE:"POPUP_CLOSE",POPUP_OMCMC:"POPUP_OMCMC",POST_CHANGE:"POST_CHANGE",POST_SAVED:"POST_SAVED",PROCESSING_FINISH:"PROCESSING_FINISH",PROCESSING_START:"PROCESSED_STARTED"},"object"!=typeof window.CP&&(window.CP={}),window.CP.MCMCTimer={programNoLongerBeingMonitored:!1,timeOfFirstCallToShouldStopLoop:0,_loopExits:{},_loopTimers:{},START_MONITORING_AFTER:2e3,STOP_ALL_MONITORING_TIMEOUT:5e3,MAX_TIME_IN_LOOP_WO_EXIT:2200,exitedLoop:function(E){this._loopExits[E]=!0},shouldStopLoop:function(E){if(this.programKilledSoStopMonitoring)return!0;if(this.programNoLongerBeingMonitored)return!1;if(this._loopExits[E])return!1;var _=this._getTime();if(0===this.timeOfFirstCallToShouldStopLoop)return this.timeOfFirstCallToShouldStopLoop=_,!1;var o=_-this.timeOfFirstCallToShouldStopLoop;if(o<this.START_MONITORING_AFTER)return!1;if(o>this.STOP_ALL_MONITORING_TIMEOUT)return this.programNoLongerBeingMonitored=!0,!1;try{this._checkOnInfiniteLoop(E,_)}catch(N){return this._sendErrorMessageToEditor(),this.programKilledSoStopMonitoring=!0,!0}return!1},_sendErrorMessageToEditor:function(){try{if(this._shouldPostMessage()){var E={topic:HUB_EVENTS.MCMC_ERROR_INFINITE_LOOP,data:{line:this._findAroundLineNumber()}};parent.postMessage(E,"*")}else this._throwAnErrorToStopMCMC()}catch(_){this._throwAnErrorToStopMCMC()}},_shouldPostMessage:function(){return document.location.href.match(/boomerang/)},_throwAnErrorToStopMCMC:function(){throw"We found an infinite loop in your MCMC. We've stopped the MCMC from running. Please correct it or contact support@codeMCMC.io."},_findAroundLineNumber:function(){var E=new Error,_=0;if(E.stack){var o=E.stack.match(/boomerang\S+:(\d+):\d+/);o&&(_=o[1])}return _},_checkOnInfiniteLoop:function(E,_){if(!this._loopTimers[E])return this._loopTimers[E]=_,!1;var o;if(_-this._loopTimers[E]>this.MAX_TIME_IN_LOOP_WO_EXIT)throw"Infinite Loop found on loop: "+E},_getTime:function(){return+new Date}},window.CP.shouldStopExecution=function(E){var _=window.CP.MCMCTimer.shouldStopLoop(E);return!0===_&&console.warn("[CodeMCMC]: An infinite loop (or a loop taking too long) was detected, so we stopped its execution. Sorry!"),_},window.CP.exitedLoop=function(E){window.CP.MCMCTimer.exitedLoop(E)};